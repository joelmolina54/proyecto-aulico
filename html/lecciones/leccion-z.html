<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lección Z - GRAFI</title>
  <link rel="shortcut icon" href="../../assets/images/savila.png" type="image/x-icon">
  <!-- CDNs -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="shortcut icon" href="../../assets/images/savila.png" type="image/x-icon">
  <link rel="stylesheet" href="../../assets/css/temaleccion.css">
  <link rel="stylesheet" href="../../assets/css/selecciones.css">
    <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            dark: {
              800: '#1e293b',
              900: '#0f172a',
            }
          }
        }
      }
    }
  </script>
</head>
<body class="bg-gray-50 dark:bg-dark-900 text-gray-800 dark:text-gray-100 transition-colors duration-300 min-h-screen flex flex-col">
<nav class="gradient-bg dark:bg-gradient-to-r dark:from-purple-900 dark:to-purple-800 text-white shadow-lg dark:shadow-purple-900/50 sticky top-0 z-50 transition-colors duration-300">
  <div class="container mx-auto px-4 py-3 flex justify-between items-center">
    
    <!-- Logo -->
    <a href="../../index.html" class="flex items-center text-xl font-bold text-white hover:text-purple-200 dark:text-purple-100 dark:hover:text-purple-300 transition">
      <img src="../../assets/images/savila.png" alt="Logo GRAFI" class="w-8 h-8 mr-2">
      <span>Grafema</span>
    </a>
    
    <!-- Botón mobile menu -->
    <button id="mobile-menu-button" class="md:hidden p-2 rounded-full focus:outline-none bg-white bg-opacity-20 dark:bg-purple-800/30 hover:bg-white hover:bg-opacity-30 dark:hover:bg-purple-700/50 transition">
      <i class="fas fa-bars text-white dark:text-yellow-300"></i>
    </button>

    <!-- Contenido del nav (desktop) -->
    <div class="hidden md:flex items-center space-x-4">
      <a href="../lecciones.html" class="text-white hover:text-purple-200 dark:text-purple-100 dark:hover:text-purple-300 font-medium transition flex items-center">
        <i class="fas fa-arrow-left mr-2"></i> Volver
      </a>
      
      <div class="flex items-center">
        <span class="mr-2 text-sm text-white dark:text-purple-200">Progreso</span>
        <div class="w-24 bg-white bg-opacity-20 dark:bg-purple-700/30 rounded-full h-2 overflow-hidden">
          <div id="progress-bar" class="bg-yellow-300 dark:bg-amber-400 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
        </div>
        <button id="dark-mode-toggle" class="ml-4 p-2 rounded-full focus:outline-none bg-white bg-opacity-20 dark:bg-purple-800/30 hover:bg-white hover:bg-opacity-30 dark:hover:bg-purple-700/50 transition">
          <i class="fas fa-moon text-white dark:text-yellow-300"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Menú móvil -->
  <div id="mobile-menu" class="md:hidden hidden px-4 pb-4">
    <a href="../lecciones.html" class="block text-white dark:text-purple-100 hover:text-purple-200 dark:hover:text-purple-300 py-2 border-b border-white border-opacity-10">Volver</a>
    <div class="mt-2 flex items-center">
      <span class="mr-2 text-sm text-white dark:text-purple-200">Progreso</span>
      <div class="w-24 bg-white bg-opacity-20 dark:bg-purple-700/30 rounded-full h-2 overflow-hidden">
        <div id="progress-bar-mobile" class="bg-yellow-300 dark:bg-amber-400 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
      </div>
      <button id="dark-mode-toggle-mobile" class="ml-4 p-2 rounded-full focus:outline-none bg-white bg-opacity-20 dark:bg-purple-800/30 hover:bg-white hover:bg-opacity-30 dark:hover:bg-purple-700/50 transition">
        <i class="fas fa-moon text-white dark:text-yellow-300"></i>
      </button>
    </div>
  </div>
</nav>


  <main class="flex-grow container mx-auto px-4 py-8">
    <!-- Encabezado con animación -->
    <header class="text-center mb-12 fade-in">
      <div class="relative w-32 h-32 mx-auto mb-6">
        <svg class="w-full h-full" viewBox="0 0 100 100">
          <circle class="text-gray-200" stroke-width="8" stroke="currentColor" fill="transparent" r="40" cx="50" cy="50" />
          <circle id="progress-ring" class="text-purple-600 progress-ring__circle" stroke-width="8" stroke-linecap="round" stroke="currentColor" fill="transparent" r="40" cx="50" cy="50" stroke-dasharray="251.2" stroke-dashoffset="251.2" />
        </svg>
        <div class="absolute inset-0 flex items-center justify-center text-5xl font-bold text-purple-700 animate-bounce-slow">
          Z
        </div>
      </div>
      <h1 class="text-4xl font-bold text-gray-800 mb-2">Letra <span class="gradient-text bg-gradient-to-r from-purple-600 to-blue-500 bg-clip-text text-transparent">Z</span></h1>
      <p class="text-lg text-gray-600 max-w-2xl mx-auto">Aprende el sonido de la letra Z y su uso correcto.</p>
    </header>

    <!-- Sección de aprendizaje -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12">
      <!-- Video explicativo -->
      <section class="lg:col-span-2 bg-white rounded-xl shadow-lg overflow-hidden card-hover">
        <div class="p-6">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-2xl font-bold text-gray-800 flex items-center">
              <i class="fab fa-youtube text-red-600 mr-3 text-2xl"></i> Video explicativo
            </h2>
            <div class="relative">
              <button id="video-menu-btn" class="text-gray-500 hover:text-purple-600">
                <i class="fas fa-ellipsis-v"></i>
              </button>
              <div id="video-menu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10">
                <div class="py-1">
                  <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-purple-50" onclick="suggestVideo()">Sugerir video</a>
                  <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-purple-50" onclick="changeSpeed()">Cambiar velocidad</a>
                </div>
              </div>
            </div>
          </div>
          
          <div class="aspect-w-16 aspect-h-9 mb-4">
            <iframe id="youtube-video" class="w-full h-64 md:h-96 rounded-lg shadow" src="https://www.youtube.com/embed/EII0XT40bFE?si=ZahvI_cbXNzTywvB" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
          <div class="bg-purple-50 rounded-lg p-4">
            <h3 class="font-medium text-purple-800 mb-2">Resumen del video</h3>
            <p class="text-gray-700 text-sm">La letra Z en español tiene un sonido fricativo que varía según la región, pero suele pronunciarse como /θ/ en España y /s/ en gran parte de Latinoamérica.</p>
            <div class="mt-3 flex items-center text-sm text-purple-600">
              <i class="fas fa-clock mr-2"></i>
              <span>Duración: 8 min</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Teoría resumida -->
      <section class="bg-white rounded-xl shadow-lg overflow-hidden card-hover">
        <div class="gradient-bg px-6 py-4">
          <h2 class="text-xl font-bold text-white flex items-center">
            <i class="fas fa-lightbulb mr-3"></i> Conceptos clave
          </h2>
        </div>
        <div class="p-6">
          <div class="mb-6">
            <div class="flex items-start mb-4">
              <div class="bg-blue-100 p-2 rounded-full mr-3">
                <i class="fas fa-volume-up text-blue-600"></i>
              </div>
              <div>
                <h3 class="font-bold text-gray-800 mb-1">Sonido /z/ o /s/</h3>
                <p class="text-gray-600 text-sm">En España, la Z se pronuncia como /θ/, mientras que en la mayoría de Latinoamérica se pronuncia como /s/.</p>
                <div class="mt-2 flex flex-wrap gap-2">
                  <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">zapato</span>
                  <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">cereza</span>
                  <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">luz</span>
                </div>
              </div>
            </div>
            
            <div class="flex items-start">
              <div class="bg-purple-100 p-2 rounded-full mr-3">
                <i class="fas fa-volume-up text-purple-600"></i>
              </div>
              <div>
                <h3 class="font-bold text-gray-800 mb-1">Uso de la Z</h3>
                <p class="text-gray-600 text-sm">La Z se usa principalmente al inicio o en medio de palabra y en plural de sustantivos terminados en vocal:</p>
                <div class="mt-2 flex flex-wrap gap-2">
                  <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">inicial: zapato</span>
                  <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">media: cereza</span>
                  <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">final: lápiz → lápices</span>
                </div>
              </div>
            </div>
          </div>

          <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r">
            <div class="flex">
              <div class="flex-shrink-0">
                <i class="fas fa-info-circle text-yellow-500"></i>
              </div>
              <div class="ml-3">
                <p class="text-sm text-yellow-700">
                  En algunos dialectos, la Z se pronuncia igual que la S, fenómeno llamado seseo.
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>

    </div>

    <!-- Sección de práctica -->
<section class="mb-12">
  <div class="flex items-center mb-6">
    <h2 class="text-3xl font-bold text-gray-800">
      <i class="fas fa-dumbbell text-purple-600 mr-3"></i> Practica lo aprendido
    </h2>
    <div class="ml-auto flex items-center">
      <span class="text-sm text-gray-500 mr-2">Nivel de dificultad:</span>
      <select class="border rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500">
        <option>Principiante</option>
        <option>Intermedio</option>
        <option>Avanzado</option>
      </select>
    </div>
  </div>
  
  <!-- Pestañas de ejercicios -->
  <div class="bg-white rounded-xl shadow-lg overflow-hidden">
    <div class="border-b border-gray-200">
      <nav class="flex -mb-px">
        <button id="tab-ejercicio1" class="tab-button active py-4 px-6 text-center border-b-2 font-medium text-sm border-purple-500 text-purple-600">
          Ejercicio 1
        </button>
        <button id="tab-ejercicio2" class="tab-button py-4 px-6 text-center border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
          Ejercicio 2
        </button>
        <button id="tab-ejercicio3" class="tab-button py-4 px-6 text-center border-b-2 font-medium text-sm border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
          Ejercicio 3
        </button>
      </nav>
    </div>
    
    <!-- Contenido de las pestañas -->
    <div class="p-6">
      <!-- Ejercicio 1 - Selección múltiple -->
      <div id="content-ejercicio1" class="tab-content active">
        <h3 class="text-xl font-bold text-gray-800 mb-4">Completa las palabras con Z</h3>
        <p class="text-gray-600 mb-6">Selecciona la letra correcta para completar cada palabra según su sonido.</p>
        
        <div class="space-y-4">
          <div class="flex flex-col md:flex-row md:items-center p-4 rounded-lg border border-gray-200 dark:border-gray-600 ejercicio-container"  data-respuesta="z">
            <div class="md:w-1/3 mb-2 md:mb-0">
              <span class="text-gray-700 dark:text-blue-400">___orro</span>
            </div>
            <div class="md:w-1/3">
              <select class="w-full border rounded-lg px-3 py-2 ejercicio-select focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-dark-700 dark:border-gray-600">
                <option value="">Selecciona una opción</option>
                <option value="z">Z</option>
                <option value="s">S</option>
              </select>
            </div>
            <div class="md:w-1/3 mt-2 md:mt-0 md:pl-4 ejercicio-feedback hidden">
              <div class="flex items-center">
                <i class="fas fa-check-circle text-green-500 mr-2 hidden correct-icon"></i>
                <i class="fas fa-times-circle text-red-500 mr-2 hidden incorrect-icon"></i>
                <span class="text-sm feedback-text"></span>
              </div>
            </div>
          </div>
          
          <div class="flex flex-col md:flex-row md:items-center p-4 rounded-lg border border-gray-200 ejercicio-container" data-respuesta="z">
            <div class="md:w-1/3 mb-2 md:mb-0">
              <span class="text-gray-700 dark:text-blue-400">pa___</span>
            </div>
            <div class="md:w-1/3">
              <select class="w-full border rounded-lg px-3 py-2 ejercicio-select focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-dark-700 dark:border-gray-600">
                <option value="">Selecciona una opción</option>
                <option value="z">Z</option>
                <option value="s">S</option>
              </select>
            </div>
            <div class="md:w-1/3 mt-2 md:mt-0 md:pl-4 ejercicio-feedback hidden">
              <div class="flex items-center">
                <i class="fas fa-check-circle text-green-500 mr-2 hidden correct-icon"></i>
                <i class="fas fa-times-circle text-red-500 mr-2 hidden incorrect-icon"></i>
                <span class="text-sm feedback-text"></span>
              </div>
            </div>
          </div>
          
          <div class="flex flex-col md:flex-row md:items-center p-4 rounded-lg border border-gray-200 ejercicio-container" data-respuesta="z">
            <div class="md:w-1/3 mb-2 md:mb-0">
              <span class="text-gray-700 dark:text-blue-400"> me___cla</span>
            </div>
            <div class="md:w-1/3">
              <select class="w-full border rounded-lg px-3 py-2 ejercicio-select focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-dark-700 dark:border-gray-600">
                <option value="">Selecciona una opción</option>
                <option value="z">Z</option>
                <option value="s">S</option>
              </select>
            </div>
            <div class="md:w-1/3 mt-2 md:mt-0 md:pl-4 ejercicio-feedback hidden">
              <div class="flex items-center">
                <i class="fas fa-check-circle text-green-500 mr-2 hidden correct-icon"></i>
                <i class="fas fa-times-circle text-red-500 mr-2 hidden incorrect-icon"></i>
                <span class="text-sm feedback-text"></span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="mt-6 flex justify-end">
          <button id="check-ejercicio1" class="btn-primary text-white px-6 py-2 rounded-lg font-medium">
            <i class="fas fa-check-circle mr-2"></i> Comprobar respuestas
          </button>
        </div>
      </div>
      
      <!-- Ejercicio 2 - Clasificación -->
      <div id="content-ejercicio2" class="tab-content hidden">
        <h3 class="text-xl font-bold text-gray-800 mb-4">Clasifica las palabras según la posición de la Z</h3>
        <p class="text-gray-600 mb-6">Arrastra cada palabra al área correspondiente según la posición de la letra Z en la palabra.</p>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
          <div id="target-inicial" class="bg-blue-50 border-2 border-dashed border-blue-300 rounded-xl p-4 min-h-32 flex flex-col">
            <div class="text-center text-blue-700 dark:text-blue-300 font-medium mb-2">
              <i class="fas fa-volume-up mr-2"></i> Z inicial
            </div>
            <div class="flex-grow flex flex-wrap gap-2 content-start" id="words-inicial"></div>
          </div>
          
          <div id="target-media" class="bg-purple-50 border-2 border-dashed border-purple-300 rounded-xl p-4 min-h-32 flex flex-col">
            <div class="text-center text-green-700 dark:text-green-300 font-medium mb-2">
              <i class="fas fa-volume-up mr-2"></i> Z media
            </div>
            <div class="flex-grow flex flex-wrap gap-2 content-start" id="words-media"></div>
          </div>
          
          <div id="target-final" class="bg-green-50 border-2 border-dashed border-green-300 rounded-xl p-4 min-h-32 flex flex-col">
            <div class="text-center text-green-700 font-medium mb-2">
              <i class="fas fa-volume-up mr-2"></i> Z final
            </div>
            <div class="flex-grow flex flex-wrap gap-2 content-start" id="words-final"></div>
          </div>
        </div>
        
        <div id="palabras-arrastrar" class="flex flex-wrap gap-3 p-4 bg-gray-50 rounded-lg">
          <div  class="bg-white dark:bg-dark-600 shadow-sm rounded-lg px-4 py-2 cursor-move draggable-word" draggable="true" data-posicion="inicial">
            <span class="text-gray-800">zorro</span>
          </div>
          <div  class="bg-white dark:bg-dark-600 shadow-sm rounded-lg px-4 py-2 cursor-move draggable-word" draggable="true" data-posicion="media">
            <span class="text-gray-800">pizza</span>
          </div>
          <div  class="bg-white dark:bg-dark-600 shadow-sm rounded-lg px-4 py-2 cursor-move draggable-word" draggable="true" data-posicion="final">
            <span class="text-gray-800">luz</span>
          </div>
          <div  class="bg-white dark:bg-dark-600 shadow-sm rounded-lg px-4 py-2 cursor-move draggable-word" draggable="true" data-posicion="inicial">
            <span class="text-gray-800">zapato</span>
          </div>
          <div  class="bg-white dark:bg-dark-600 shadow-sm rounded-lg px-4 py-2 cursor-move draggable-word" draggable="true" data-posicion="media">
            <span class="text-gray-800">mezcla</span>
          </div>
          <div  class="bg-white dark:bg-dark-600 shadow-sm rounded-lg px-4 py-2 cursor-move draggable-word" draggable="true" data-posicion="final">
            <span class="text-gray-800">raíz</span>
          </div>
        </div>
        
        <div id="feedback-arrastrar" class="hidden mt-6">
          <div class="p-4 rounded-lg bg-green-50 border border-green-200 feedback-content">
            <div class="flex items-center">
              <i class="fas fa-check-circle text-green-500 text-xl mr-3"></i>
              <div>
                <h4 class="font-bold text-green-800">¡Bien hecho!</h4>
                <p class="text-green-700 text-sm">Has clasificado correctamente todas las palabras según la posición de la Z.</p>
              </div>
            </div>
          </div>
        </div>
        
        <div class="mt-6 flex justify-between">
          <button id="reset-ejercicio2" class="bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 px-6 py-2 rounded-lg font-medium">
            <i class="fas fa-redo mr-2"></i> Reiniciar
          </button>
          <button id="check-ejercicio2" class="btn-primary text-white px-6 py-2 rounded-lg font-medium">
            <i class="fas fa-check-circle mr-2"></i> Comprobar
          </button>
        </div>
      </div>
      
      <!-- Ejercicio 3 - Dictado -->
      <!-- Ejercicio 3 - Dictado -->
<div id="content-ejercicio3" class="tab-content hidden">
  <h3 class="text-xl font-bold text-gray-800 mb-4">Dictado con palabras que contienen Z</h3>
  <p class="text-gray-600 mb-6">Escucha atentamente el audio y escribe las palabras que contengan la letra Z.</p>
  
  <div class="bg-blue-50 rounded-lg p-6 mb-6">
    <audio id="dictation-audio-player" controls class="w-full mb-4">
      <source src="../../assets/audio/pronunciation_es_zapatos.mp3" type="audio/mpeg">
      Tu navegador no soporta el elemento de audio.
    </audio>
    
    <button id="play-dictation" class="btn-secondary text-white px-6 py-3 rounded-lg font-medium">
      <i class="fas fa-play mr-2"></i> Reproducir audio
    </button>
  </div>
  
  <div class="mb-6">
    <label for="dictation-text" class="block text-gray-700 dark:text-gray-300 font-medium mb-2">
      Escribe las palabras con Z que escuches:
    </label>
    <textarea id="dictation-text" rows="4" class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-dark-700 dark:border-gray-600"></textarea>
  </div>
  
  <div id="dictation-feedback" class="hidden p-4 rounded-lg bg-purple-50 border border-purple-200 mb-6">
    <div class="flex items-center">
      <i class="fas fa-info-circle text-purple-600 text-xl mr-3"></i>
      <div>
        <h4 class="font-bold text-purple-800 dark:text-white">Retroalimentación</h4>
        <p class="text-purple-700 text-sm dark:text-white">Las palabras que contenían Z eran: 
          <span id="dictation-words" class="font-bold dark:text-white">zapato, zorro, luz, pez, zumo</span>
        </p>
      </div>
    </div>
  </div>
  
  <div class="flex justify-end">
    <button id="check-dictation" class="btn-primary text-white px-6 py-2 rounded-lg font-medium">
      <i class="fas fa-check-circle mr-2"></i> Comprobar
    </button>
  </div>
</div>
    </div>
  </div>
</section>


    <!-- Sección de finalización -->
<section class="mb-12">
  <div class="bg-gradient-to-r from-purple-600 to-blue-500 rounded-xl shadow-lg overflow-hidden p-8 text-center">
    <div class="max-w-2xl mx-auto">
      <h2 class="text-2xl font-bold text-white mb-4">¿Listo para completar la lección?</h2>
      <p class="text-purple-100 mb-6">Has progresado mucho. Completa todos los ejercicios para finalizar esta lección.</p>
      
      <div class="flex flex-col sm:flex-row justify-center gap-4">
        <button id="btn-completar" class="bg-white text-purple-600 hover:bg-gray-100 px-6 py-3 rounded-lg font-medium shadow-md transition dark:hover:bg-gray-700">
          <i class="fas fa-flag-checkered mr-2"></i> Terminar lección
        </button>
        
        <button id="btn-reiniciar-todo" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-6 py-3 rounded-lg font-medium shadow-md transition">
          <i class="fas fa-redo mr-2"></i> Reiniciar todo
        </button>
      </div>
    </div>
  </div>
</section>
</main>

<!-- Footer -->
<footer class="bg-gray-800 text-gray-300 py-8">
  <div class="container mx-auto px-4">
    <div class="flex flex-col md:flex-row justify-between items-center">
      <div class="mb-4 md:mb-0">
        <a href="../../index.html" class="flex items-center text-xl font-bold text-white">
          <img src="../../assets/images/savila.png" alt="Logo GRAFI" class="w-8 h-8 mr-2">
          <span>Grafema</span>
        </a>
        <p class="mt-2 text-sm">Aprendizaje interactivo de grafemas y fonemas.</p>
      </div>
      
      <div class="flex space-x-4">
        <a href="https://www.facebook.com/profile.php?id=100009295328147&locale=es_LA" class="text-gray-400 hover:text-white transition">
          <i class="fab fa-facebook-f"></i>
        </a>
        <a href="https://www.instagram.com/joelmolina54/" class="text-gray-400 hover:text-white transition">
          <i class="fab fa-instagram"></i>
        </a>
        <a href="https://github.com/joelmolina54" class="text-gray-400 hover:text-white transition">
          <i class="fab fa-github"></i>
        </a>
      </div>
    </div>
    
    <div class="border-t border-gray-700 mt-6 pt-6 text-center text-sm">
      <p>&copy; 2025 GRAFI. Todos los derechos reservados.</p>
    </div>
  </div>
</footer>

<!-- Modal universal -->
<div id="universal-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
  <div class="bg-white rounded-xl shadow-2xl overflow-hidden w-full max-w-md transform transition-all">
    <div id="modal-header" class="gradient-bg p-6 text-center text-white">
      <i id="modal-icon" class="fas fa-check-circle text-4xl mb-4"></i>
      <h3 id="modal-title" class="text-2xl font-bold">Título del modal</h3>
    </div>
    
    <div class="p-6 text-center">
      <p id="modal-message" class="text-gray-600 mb-6">Mensaje del modal aquí.</p>
      
      <div class="flex flex-col space-y-3">
        <button id="modal-primary-btn" class="btn-primary text-white px-6 py-3 rounded-lg font-medium">
          <i class="fas fa-check mr-2"></i> Aceptar
        </button>
        <button id="modal-secondary-btn" class="border border-gray-300 text-gray-700 hover:bg-gray-50 px-6 py-3 rounded-lg font-medium hidden">
          <i class="fas fa-times mr-2"></i> Cancelar
        </button>
      </div>
    </div>
  </div>
</div>

  <script src="/assets/js/achievements.js"></script>
  <script src="../../assets/js/temaleccionesclases.js"></script>
  <script src="../../assets/js/menu-movil.js"></script>
<script>
  // Variables globales para el progreso
  let progresoActual = 0;
  const progresoPorEjercicio = {
    ejercicio1: 30,
    ejercicio2: 30,
    ejercicio3: 40
  };

  // Configuración inicial al cargar la página
  document.addEventListener('DOMContentLoaded', function() {
    // Inicializar progreso
    progresoActual = parseInt(localStorage.getItem('progreso-z')) || 0;
    updateProgress(progresoActual);

    // Configurar pestañas
    setupTabs();

    // Configurar drag and drop
    setupDragDrop();

    // Configurar eventos de los botones
    setupButtons();

    // Comprobar si ya está completado
    if(progresoActual === 100) {
      const btnCompletar = document.getElementById('btn-completar');
      btnCompletar.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Lección completada';
      btnCompletar.classList.add('bg-green-500', 'text-white');
    }
  });

  // Actualizar progreso visual
  function updateProgress(percent) {
    document.getElementById('progress-bar').style.width = `${percent}%`;

    // Actualizar anillo de progreso
    const circle = document.getElementById('progress-ring');
    if (circle) {
      const radius = circle.r.baseVal.value;
      const circumference = 2 * Math.PI * radius;
      const offset = circumference - (percent / 100) * circumference;
      circle.style.strokeDashoffset = offset;
    }
  }

  // Configurar sistema de pestañas
  function setupTabs() {
    const tabs = document.querySelectorAll('.tab-button');
    const contents = document.querySelectorAll('.tab-content');

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => {
          t.classList.remove('active', 'border-purple-500', 'text-purple-600');
          t.classList.add('border-transparent', 'text-gray-500');
        });
        contents.forEach(c => {
          c.classList.remove('active');
          c.classList.add('hidden');
        });

        tab.classList.add('active', 'border-purple-500', 'text-purple-600');
        tab.classList.remove('border-transparent', 'text-gray-500');

        const contentId = tab.id.replace('tab-', 'content-');
        const contentElement = document.getElementById(contentId);
        if (contentElement) {
          contentElement.classList.add('active');
          contentElement.classList.remove('hidden');
        }
      });
    });
  }

  // Configurar drag and drop
  function setupDragDrop() {
    const draggables = document.querySelectorAll('.draggable-word');
    const targets = document.querySelectorAll('[id^="target-"]');

    draggables.forEach(d => {
      d.addEventListener('dragstart', () => {
        d.classList.add('opacity-50', 'border-yellow-500');
      });
      d.addEventListener('dragend', () => {
        d.classList.remove('opacity-50', 'border-yellow-500');
      });
    });

    targets.forEach(target => {
      target.addEventListener('dragover', e => {
        e.preventDefault();
        const afterElement = getDragAfterElement(target, e.clientY);
        const draggable = document.querySelector('.draggable-word.border-yellow-500');

        if (draggable) {
          if (afterElement == null) {
            target.appendChild(draggable);
          } else {
            target.insertBefore(draggable, afterElement);
          }
        }
      });
    });
  }

  function getDragAfterElement(container, y) {
    const draggableElements = [...container.querySelectorAll('.draggable-word:not(.border-yellow-500)')];
    return draggableElements.reduce((closest, child) => {
      const box = child.getBoundingClientRect();
      const offset = y - box.top - box.height / 2;
      if (offset < 0 && offset > closest.offset) {
        return { offset: offset, element: child };
      } else {
        return closest;
      }
    }, { offset: Number.NEGATIVE_INFINITY }).element;
  }

  // Configuración de botones (VERSIÓN CORREGIDA)
  function setupButtons() {
document.getElementById('play-dictation').addEventListener('click', function() {
  const audioPlayer = document.getElementById('dictation-audio-player');
  audioPlayer.play();
});

document.getElementById('check-dictation').addEventListener('click', function() {
  const textoUsuario = document.getElementById('dictation-text').value.toLowerCase();
  const palabrasEsperadas = ['zapatos']; // Palabras con Z en el audio
  
  // Mostrar retroalimentación
  const feedback = document.getElementById('dictation-feedback');
  feedback.classList.remove('hidden');
  
  // Verificar cuántas palabras correctas escribió el usuario
  const palabrasCorrectas = palabrasEsperadas.filter(palabra => 
    textoUsuario.includes(palabra)
  ).length;
  
  if (palabrasCorrectas === palabrasEsperadas.length && progresoActual < 100) {
    progresoActual = 100;
    updateProgress(progresoActual);
    showModal({
      title: '¡Dictado perfecto!',
      message: `Identificaste todas las palabras con Z (${palabrasCorrectas}/${palabrasEsperadas.length})`,
      icon: 'fas fa-trophy text-yellow-500',
      primaryText: 'Finalizar'
    });
  } else {
    showModal({
      title: 'Buen intento',
      message: `Identificaste ${palabrasCorrectas} de ${palabrasEsperadas.length} palabras con Z.`,
      icon: 'fas fa-info-circle text-blue-500',
      primaryText: 'Entendido'
    });
  }
});
// Ejercicio 1: selección múltiple (VERSIÓN CORREGIDA)
document.getElementById('check-ejercicio1').addEventListener('click', function() {
  let allCorrect = true;
  let allAnswered = true;
  const containers = document.querySelectorAll('.ejercicio-container');

  // Primera pasada: Verificar si todas están respondidas y mostrar feedback
  containers.forEach(container => {
    const select = container.querySelector('.ejercicio-select');
    const feedback = container.querySelector('.ejercicio-feedback');
    const correctIcon = container.querySelector('.correct-icon');
    const incorrectIcon = container.querySelector('.incorrect-icon');
    const feedbackText = container.querySelector('.feedback-text');
    const respuestaCorrecta = container.getAttribute('data-respuesta');

    // Verificar si se seleccionó una opción
    if (!select || select.value === "") {
      allAnswered = false;
      container.classList.add('border-yellow-200', 'bg-yellow-50', 'shake');
      container.classList.remove('border-green-200', 'bg-green-100', 'border-red-200', 'bg-red-50');
      
      if (feedback) {
        feedback.classList.remove('hidden');
        if (feedbackText) {
          feedbackText.textContent = "Por favor selecciona una opción";
          feedbackText.className = 'text-sm text-yellow-600 feedback-text';
        }
        if (correctIcon) correctIcon.classList.add('hidden');
        if (incorrectIcon) incorrectIcon.classList.add('hidden');
      }
      return;
    }

    // Mostrar feedback
    if (feedback) feedback.classList.remove('hidden');

    // Verificar respuesta
    if (select.value === respuestaCorrecta) {
      if (correctIcon) correctIcon.classList.remove('hidden');
      if (incorrectIcon) incorrectIcon.classList.add('hidden');
      container.classList.add('border-green-400', 'bg-green-50');
      container.classList.remove('border-red-200', 'bg-red-50', 'shake', 'border-yellow-200', 'bg-yellow-50');
      if (feedbackText) {
        feedbackText.textContent = `¡Correcto! La respuesta es "${respuestaCorrecta.toUpperCase()}".`;
        feedbackText.className = 'text-sm text-green-600 feedback-text';
      }
    } else {
      if (correctIcon) correctIcon.classList.add('hidden');
      if (incorrectIcon) incorrectIcon.classList.remove('hidden');
      container.classList.add('border-red-200', 'bg-red-50', 'shake');
      container.classList.remove('border-green-200', 'bg-green-50', 'border-yellow-200', 'bg-yellow-50');
      allCorrect = false;
      if (feedbackText) {
        feedbackText.textContent = `Incorrecto. La respuesta correcta es "${respuestaCorrecta.toUpperCase()}".`;
        feedbackText.className = 'text-sm text-red-600 feedback-text';
      }
    }
  });

  // Si no todas están respondidas, mostrar advertencia
  if (!allAnswered) {
    showModal({
      title: 'Respuestas incompletas',
      message: 'Por favor responde todas las preguntas antes de comprobar.',
      icon: 'fas fa-exclamation-triangle text-yellow-500',
      primaryText: 'Entendido'
    });
    return;
  }

  // Si todas están correctas y es la primera vez
  if (allCorrect) {
    // Verificar si ya tenía este progreso para no mostrar el modal nuevamente
    const alreadyCompleted = progresoActual >= progresoPorEjercicio.ejercicio1;
    
    if (!alreadyCompleted) {
      progresoActual = progresoPorEjercicio.ejercicio1;
      updateProgress(progresoActual);
      showModal({
        title: '¡Ejercicio 1 completado!',
        message: `Progreso actual: ${progresoActual}% - Completa los demás ejercicios.`,
        icon: 'fas fa-check-circle text-green-500',
        primaryText: 'Continuar'
      });
    }
  } else {
    showModal({
      title: 'Corrige los errores',
      message: 'Algunas respuestas son incorrectas. Revisa los mensajes de retroalimentación.',
      icon: 'fas fa-exclamation-circle text-red-500',
      primaryText: 'Entendido'
    });
  }
});

    // Ejercicio 2: clasificación
    document.getElementById('check-ejercicio2').addEventListener('click', function() {
      let palabrasCorrectas = 0;
      const totalPalabras = 6; // Total de palabras a clasificar

      // Verificar palabras en cada categoría
      document.querySelectorAll('[id^="target-"]').forEach(target => {
        const posicionEsperada = target.id.split('-')[1];
        const palabras = target.querySelectorAll('.draggable-word');
        
        palabras.forEach(palabra => {
          if (palabra.getAttribute('data-posicion') === posicionEsperada) {
            palabrasCorrectas++;
          }
        });
      });

      if (palabrasCorrectas === totalPalabras && progresoActual < 60) {
        progresoActual = progresoPorEjercicio.ejercicio1 + progresoPorEjercicio.ejercicio2;
        updateProgress(progresoActual);
        showModal({
          title: '¡Ejercicio 2 completado!',
          message: `Progreso actual: ${progresoActual}% - Solo falta el dictado.`,
          icon: 'fas fa-check-circle text-green-500',
          primaryText: 'Continuar'
        });
      } else {
        showModal({
          title: '¡Ups! Error en la clasificación',
          message: `Tienes ${palabrasCorrectas}/${totalPalabras} palabras correctas.`,
          icon: 'fas fa-exclamation-circle text-yellow-500',
          primaryText: 'Entendido'
        });
      }
    });

    // Ejercicio 3: dictado
    document.getElementById('check-dictation').addEventListener('click', function() {
      const textoUsuario = document.getElementById('dictation-text').value.toLowerCase();
      const palabrasEsperadas = ['zapato']; // Palabras con Z que debería escuchar
      const palabrasEncontradas = palabrasEsperadas.filter(palabra => textoUsuario.includes(palabra));

      if (palabrasEncontradas.length === palabrasEsperadas.length) {
        progresoActual = 100;
        updateProgress(progresoActual);
        showModal({
          title: '¡Dictado perfecto!',
          message: '¡Has completado el 100% de la lección!',
          icon: 'fas fa-trophy text-yellow-500',
          primaryText: 'Finalizar'
        });
      } else {
        showModal({
          title: 'Buen intento',
          message: `Encontraste ${palabrasEncontradas.length} de ${palabrasEsperadas.length} palabras.`,
          icon: 'fas fa-info-circle text-blue-500',
          primaryText: 'Intentar de nuevo'
        });
      }
    });

    // Botón "Terminar lección" (Versión corregida)
    document.getElementById('btn-completar').addEventListener('click', function() {
      if (progresoActual >= 100) {
        localStorage.setItem('progreso-z', '100');
        this.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Lección completada';
        this.classList.add('bg-green-500', 'text-white');
        
        showModal({
          title: '¡Lección completada!',
          message: 'La lección Z se ha marcado como completada.',
          icon: 'fas fa-check-circle text-green-500',
          primaryText: 'Volver a lecciones',
          onPrimary: () => window.location.href = '../lecciones.html'
        });
      } else {
        showModal({
          title: 'Lección incompleta',
          message: `Completa todos los ejercicios (${progresoActual}% actual).`,
          icon: 'fas fa-exclamation-triangle text-yellow-500',
          primaryText: 'Entendido'
        });
      }
    });

    // Botón "Reiniciar todo"
    document.getElementById('btn-reiniciar-todo').addEventListener('click', function() {
      showModal({
        title: 'Reiniciar lección',
        message: '¿Seguro que quieres reiniciar todo tu progreso en esta lección?',
        icon: 'fas fa-exclamation-triangle text-yellow-500',
        primaryText: 'Sí, reiniciar',
        secondaryText: 'Cancelar',
        onPrimary: () => {
          localStorage.removeItem('progreso-z');
          location.reload();
        }
      });
    });

    // Menú de video
    document.getElementById('video-menu-btn').addEventListener('click', function() {
      document.getElementById('video-menu').classList.toggle('hidden');
    });
  }

  // Función para mostrar modales
  function showModal({ title, message, icon, primaryText, secondaryText, onPrimary }) {
    const modal = document.getElementById('universal-modal');
    const modalTitle = document.getElementById('modal-title');
    const modalMessage = document.getElementById('modal-message');
    const modalIcon = document.getElementById('modal-icon');
    const primaryBtn = document.getElementById('modal-primary-btn');
    const secondaryBtn = document.getElementById('modal-secondary-btn');

    // Configurar contenido
    modalTitle.textContent = title;
    modalMessage.textContent = message;
    modalIcon.className = icon;

    // Configurar botón primario
    primaryBtn.innerHTML = `<i class="fas fa-check mr-2"></i> ${primaryText}`;
    primaryBtn.onclick = function() {
      modal.classList.add('hidden');
      if (onPrimary) onPrimary();
    };

    // Configurar botón secundario
    if (secondaryText) {
      secondaryBtn.innerHTML = `<i class="fas fa-times mr-2"></i> ${secondaryText}`;
      secondaryBtn.classList.remove('hidden');
      secondaryBtn.onclick = function() {
        modal.classList.add('hidden');
      };
    } else {
      secondaryBtn.classList.add('hidden');
    }

    // Mostrar modal
    modal.classList.remove('hidden');
  }

  // Funciones del menú de video
  function suggestVideo() {
    showModal({
      title: 'Sugerir video',
      message: '¿Qué video te gustaría ver sobre este tema?',
      icon: 'fas fa-info-circle text-blue-500',
      primaryText: 'Enviar sugerencia'
    });
    document.getElementById('video-menu').classList.add('hidden');
  }

  function changeSpeed() {
    showModal({
      title: 'Cambiar velocidad',
      message: 'Selecciona la velocidad de reproducción:',
      icon: 'fas fa-tachometer-alt text-blue-500',
      primaryText: 'Aplicar'
    });
    document.getElementById('video-menu').classList.add('hidden');
  }
</script>
</body>
</html>
