<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lecci√≥n S - GRAFI</title>
  <link rel="shortcut icon" href="../../assets/images/savila.png" type="image/x-icon">
  <!-- CDNs -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="shortcut icon" href="../../assets/images/savila.png" type="image/x-icon">
  <link rel="stylesheet" href="../../assets/css/temaleccion.css">
  <link rel="stylesheet" href="../../assets/css/selecciones.css">
    <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            dark: {
              800: '#1e293b',
              900: '#0f172a',
            }
          }
        }
      }
    }
  </script>
</head>
<body class="bg-gray-50 dark:bg-dark-900 text-gray-800 dark:text-gray-100 transition-colors duration-300 min-h-screen flex flex-col">
<nav class="gradient-bg dark:bg-gradient-to-r dark:from-purple-900 dark:to-purple-800 text-white shadow-lg dark:shadow-purple-900/50 sticky top-0 z-50 transition-colors duration-300">
  <div class="container mx-auto px-4 py-3 flex justify-between items-center">
    
    <!-- Logo -->
    <a href="../../index.html" class="flex items-center text-xl font-bold text-white hover:text-purple-200 dark:text-purple-100 dark:hover:text-purple-300 transition">
      <img src="../../assets/images/savila.png" alt="Logo GRAFI" class="w-8 h-8 mr-2">
      <span>Grafema</span>
    </a>
    
    <!-- Bot√≥n mobile menu -->
    <button id="mobile-menu-button" class="md:hidden p-2 rounded-full focus:outline-none bg-white bg-opacity-20 dark:bg-purple-800/30 hover:bg-white hover:bg-opacity-30 dark:hover:bg-purple-700/50 transition">
      <i class="fas fa-bars text-white dark:text-yellow-300"></i>
    </button>

    <!-- Contenido del nav (desktop) -->
    <div class="hidden md:flex items-center space-x-4">
      <a href="../lecciones.html" class="text-white hover:text-purple-200 dark:text-purple-100 dark:hover:text-purple-300 font-medium transition flex items-center">
        <i class="fas fa-arrow-left mr-2"></i> Volver
      </a>
      
      <div class="flex items-center">
        <span class="mr-2 text-sm text-white dark:text-purple-200">Progreso</span>
        <div class="w-24 bg-white bg-opacity-20 dark:bg-purple-700/30 rounded-full h-2 overflow-hidden">
          <div id="progress-bar" class="bg-yellow-300 dark:bg-amber-400 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
        </div>
        <button id="dark-mode-toggle" class="ml-4 p-2 rounded-full focus:outline-none bg-white bg-opacity-20 dark:bg-purple-800/30 hover:bg-white hover:bg-opacity-30 dark:hover:bg-purple-700/50 transition">
          <i class="fas fa-moon text-white dark:text-yellow-300"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Men√∫ m√≥vil -->
  <div id="mobile-menu" class="md:hidden hidden px-4 pb-4">
    <a href="../lecciones.html" class="block text-white dark:text-purple-100 hover:text-purple-200 dark:hover:text-purple-300 py-2 border-b border-white border-opacity-10">Volver</a>
    <div class="mt-2 flex items-center">
      <span class="mr-2 text-sm text-white dark:text-purple-200">Progreso</span>
      <div class="w-24 bg-white bg-opacity-20 dark:bg-purple-700/30 rounded-full h-2 overflow-hidden">
        <div id="progress-bar-mobile" class="bg-yellow-300 dark:bg-amber-400 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
      </div>
      <button id="dark-mode-toggle-mobile" class="ml-4 p-2 rounded-full focus:outline-none bg-white bg-opacity-20 dark:bg-purple-800/30 hover:bg-white hover:bg-opacity-30 dark:hover:bg-purple-700/50 transition">
        <i class="fas fa-moon text-white dark:text-yellow-300"></i>
      </button>
    </div>
  </div>
</nav>

<main class="bg-white dark:bg-dark-800 dark:bg-opacity-90 flex-grow container mx-auto px-4 py-8 shadow-sm dark:shadow-none">
    <!-- Encabezado con animaci√≥n -->
    <header class="text-center mb-12 fade-in">
      <div class="relative w-32 h-32 mx-auto mb-6">
        <svg class="w-full h-full" viewBox="0 0 100 100">
          <circle class="text-gray-200 dark:text-purple-900/40" stroke-width="8" stroke="currentColor" fill="transparent" r="40" cx="50" cy="50" />
          <circle id="progress-ring" class="text-purple-600 dark:text-amber-400 progress-ring__circle" stroke-width="8" stroke-linecap="round" stroke="currentColor" fill="transparent" r="40" cx="50" cy="50" stroke-dasharray="251.2" stroke-dashoffset="251.2" />
        </svg>
        <div class="absolute inset-0 flex items-center justify-center text-5xl font-bold text-purple-700 dark:text-amber-400 animate-bounce-slow">
          S
        </div>
      </div>
      <h1 class="text-4xl font-bold text-gray-800 dark:text-white mb-2">
        Letra 
        <span class="bg-gradient-to-r from-purple-600 to-blue-500 dark:from-amber-400 dark:to-yellow-300 bg-clip-text text-transparent">
          S
        </span>
      </h1>
      <p class="text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">
        Aprende el sonido de la letra S en espa√±ol y su uso correcto.
      </p>
    </header>

  <!-- Secci√≥n de aprendizaje -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12">
      <!-- Video explicativo -->
      <section class="lg:col-span-2 bg-white dark:bg-dark-700 rounded-xl shadow-lg dark:shadow-purple-900/20 overflow-hidden card-hover transition-all duration-300">
        <div class="p-6">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-2xl font-bold text-gray-800 flex items-center">
              <i class="fab fa-youtube text-red-600 mr-3 text-2xl"></i> Video explicativo
            </h2>
            <div class="relative">
              <button id="video-menu-btn" class="text-gray-500 hover:text-purple-600">
                <i class="fas fa-ellipsis-v"></i>
              </button>
              <div id="video-menu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg z-10">
                <div class="py-1">
                  <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-purple-50 dark:hover:bg-purple-900/50" onclick="suggestVideo()">Sugerir video</a>
                  <a href="#" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-purple-50 dark:hover:bg-purple-900/50" onclick="changeSpeed()">Cambiar velocidad</a>
                </div>
              </div>
            </div>
          </div>
          
          <div class="aspect-w-16 aspect-h-9 mb-4">
            <iframe id="youtube-video" class="w-full h-64 md:h-96 rounded-lg shadow" src="https://www.youtube.com/embed/0Sbn4PdshX4?si=UrKKmkPttgbddpzX" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
          </div>
          
          <div class="bg-purple-50 dark:bg-dark-700 rounded-lg p-4 border border-purple-100 dark:border-purple-800 shadow-sm dark:shadow-lg transition-all duration-300">
            <h3 class="font-medium text-purple-800 dark:text-purple-200 mb-2">Resumen del video</h3>
            <p class="text-gray-700 dark:text-gray-300 text-sm">La letra S tiene un sonido sibilante en espa√±ol que puede variar ligeramente seg√∫n su posici√≥n en la palabra.</p>
            <div class="mt-3 flex items-center text-sm text-purple-600 dark:text-purple-300">
              <i class="fas fa-clock mr-2"></i>
              <span>Duraci√≥n: 10 min</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Teor√≠a resumida -->
      <section class="bg-white dark:bg-dark-700 rounded-xl shadow-lg dark:shadow-purple-900/20 overflow-hidden card-hover transition-all duration-300">
        <div class="gradient-bg dark:bg-gradient-to-r dark:from-purple-900 dark:to-purple-800 px-6 py-4">
          <h2 class="text-xl font-bold text-white flex items-center">
            <i class="fas fa-lightbulb mr-3"></i> Conceptos clave
          </h2>
        </div>
        <div class="p-6">
          <div class="mb-6">
            <div class="flex items-start mb-4">
              <div class="bg-blue-100 dark:bg-blue-900/30 p-2 rounded-full mr-3">
                <i class="fas fa-graduation-cap text-blue-600"></i>
              </div>
              <div>
                <h3 class="font-bold text-gray-800 dark:text-gray-100 mb-1">letra /s/</h3>
                <p class="text-gray-600 dark:text-gray-300 text-sm">La S siempre tiene el mismo sonido sordo en espa√±ol, pero puede variar ligeramente seg√∫n su posici√≥n:</p>
                <div class="mt-2 flex flex-wrap gap-2">
                  <span class="bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 px-3 py-1 rounded-full text-sm">sapo</span>
                  <span class="bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 px-3 py-1 rounded-full text-sm">casa</span>
                  <span class="bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300 px-3 py-1 rounded-full text-sm">sol</span>
                </div>
              </div>
            </div>
            
            <div class="flex items-start">
              <div class="bg-purple-100 dark:bg-purple-900/30 p-2 rounded-full mr-3">
                <i class="fas fa-graduation-cap text-blue-600"></i>
              </div>
              <div>
                <h3 class="font-bold text-gray-800 dark:text-gray-100 mb-1">Uso de la S</h3>
                <p class="text-gray-600 dark:text-gray-300 text-sm">La S se usa en diferentes posiciones dentro de las palabras:</p>
                <div class="mt-2 flex flex-wrap gap-2">
                  <span class="bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300 px-3 py-1 rounded-full text-sm">inicial: sol</span>
                  <span class="bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300 px-3 py-1 rounded-full text-sm">media: casa</span>
                  <span class="bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300 px-3 py-1 rounded-full text-sm">final: rat√≥n</span>
                </div>
              </div>
            </div>
          </div>

          <div class="bg-yellow-50 dark:bg-amber-900/30 border-l-4 border-yellow-400 dark:border-amber-500 p-4 rounded-r-lg transition-colors duration-300">
            <div class="flex">
              <div class="flex-shrink-0">
                <i class="fas fa-info-circle text-yellow-500 dark:text-amber-400"></i>
              </div>
              <div class="ml-3">
                <p class="text-sm text-yellow-700 dark:text-amber-100">
                  En algunas variantes del espa√±ol, la S al final de s√≠laba puede pronunciarse de manera m√°s suave o aspirarse.
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Secci√≥n de pr√°ctica -->
    <section class="mb-12">
      <div class="flex items-center mb-6">
        <h2 class="text-3xl font-bold text-gray-800 dark:text-white">
          <i class="fas fa-dumbbell text-purple-600 dark:text-amber-400 mr-3"></i> Practica lo aprendido
        </h2>
        <div class="ml-auto flex items-center">
          <span class="text-sm text-gray-500 dark:text-gray-400 mr-2">Nivel de dificultad:</span>
          <select class="border rounded-lg px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-dark-700 dark:border-gray-600 dark:text-white">
            <option>Principiante</option>
            <option>Intermedio</option>
            <option>Avanzado</option>
          </select>
        </div>
      </div>
      
      <!-- Pesta√±as de ejercicios -->
      <div class="bg-white dark:bg-dark-700 rounded-xl shadow-lg dark:shadow-purple-900/20 overflow-hidden transition-colors duration-300">
        <div class="border-b border-gray-200 dark:border-gray-600">
          <nav class="flex -mb-px">
            <button id="tab-ejercicio1" class="tab-button active py-4 px-6 text-center border-b-2 font-medium text-sm border-purple-500 text-purple-600 dark:text-purple-400">
              Ejercicio 1
            </button>
            <button id="tab-ejercicio2" class="tab-button py-4 px-6 text-center border-b-2 font-medium text-sm border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500">
              Ejercicio 2
            </button>
            <button id="tab-ejercicio3" class="tab-button py-4 px-6 text-center border-b-2 font-medium text-sm border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-500">
              Ejercicio 3
            </button>
          </nav>
        </div>
        
        <!-- Contenido de las pesta√±as -->
        <div class="p-6 bg-white dark:bg-dark-700 rounded-b-xl transition-colors duration-300">
          <!-- Ejercicio 1 - Selecci√≥n m√∫ltiple -->
          <div id="content-ejercicio1" class="tab-content active">
            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-4">Completa las palabras con S o C</h3>
            <p class="text-gray-600 dark:text-gray-300 mb-6">Selecciona la letra correcta para completar cada palabra seg√∫n su sonido.</p>
            
            <div class="space-y-4">
              <div class="flex flex-col md:flex-row md:items-center p-4 rounded-lg border border-gray-200 dark:border-gray-600 ejercicio-container bg-white dark:bg-dark-600 transition-colors duration-300" data-respuesta="s">
                <div class="md:w-1/3 mb-2 md:mb-0">
                  <span class="text-gray-700 dark:text-gray-200">___illa</span>
                </div>
                <div class="md:w-1/3">
                  <select class="w-full border rounded-lg px-3 py-2 ejercicio-select focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-dark-700 dark:border-gray-500 dark:text-white">
                    <option value="" class="dark:text-gray-300">Selecciona una opci√≥n</option>
                    <option value="c" class="dark:text-gray-300">C</option>
                    <option value="s" class="dark:text-gray-300">S</option>
                  </select>
                </div>
                <div class="md:w-1/3 mt-2 md:mt-0 md:pl-4 ejercicio-feedback hidden">
                  <div class="flex items-center">
                    <i class="fas fa-check-circle text-green-500 dark:text-green-400 mr-2 hidden correct-icon"></i>
                    <i class="fas fa-times-circle text-red-500 dark:text-red-400 mr-2 hidden incorrect-icon"></i>
                    <span class="text-sm feedback-text dark:text-gray-300"></span>
                  </div>
                </div>
              </div>
              
              <div class="flex flex-col md:flex-row md:items-center p-4 rounded-lg border border-gray-200 dark:border-gray-600 ejercicio-container bg-white dark:bg-dark-600 transition-colors duration-300" data-respuesta="s">
                <div class="md:w-1/3 mb-2 md:mb-0">
                  <span class="text-gray-700 dark:text-gray-200">___and√≠a</span>
                </div>
                <div class="md:w-1/3">
                  <select class="w-full border rounded-lg px-3 py-2 ejercicio-select focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-dark-700 dark:border-gray-500 dark:text-white">
                    <option value="" class="dark:text-gray-300">Selecciona una opci√≥n</option>
                    <option value="c" class="dark:text-gray-300">C</option>
                    <option value="s" class="dark:text-gray-300">S</option>
                  </select>
                </div>
                <div class="md:w-1/3 mt-2 md:mt-0 md:pl-4 ejercicio-feedback hidden">
                  <div class="flex items-center">
                    <i class="fas fa-check-circle text-green-500 dark:text-green-400 mr-2 hidden correct-icon"></i>
                    <i class="fas fa-times-circle text-red-500 dark:text-red-400 mr-2 hidden incorrect-icon"></i>
                    <span class="text-sm feedback-text dark:text-gray-300"></span>
                  </div>
                </div>
              </div>
              
              <div class="flex flex-col md:flex-row md:items-center p-4 rounded-lg border border-gray-200 dark:border-gray-600 ejercicio-container bg-white dark:bg-dark-600 transition-colors duration-300" data-respuesta="s">
                <div class="md:w-1/3 mb-2 md:mb-0">
                  <span class="text-gray-700 dark:text-gray-200">___ol</span>
                </div>
                <div class="md:w-1/3">
                  <select class="w-full border rounded-lg px-3 py-2 ejercicio-select focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-dark-700 dark:border-gray-500 dark:text-white">
                    <option value="" class="dark:text-gray-300">Selecciona una opci√≥n</option>
                    <option value="c" class="dark:text-gray-300">C</option>
                    <option value="s" class="dark:text-gray-300">S</option>
                  </select>
                </div>
                <div class="md:w-1/3 mt-2 md:mt-0 md:pl-4 ejercicio-feedback hidden">
                  <div class="flex items-center">
                    <i class="fas fa-check-circle text-green-500 dark:text-green-400 mr-2 hidden correct-icon"></i>
                    <i class="fas fa-times-circle text-red-500 dark:text-red-400 mr-2 hidden incorrect-icon"></i>
                    <span class="text-sm feedback-text dark:text-gray-300"></span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="mt-6 flex justify-end">
              <button id="check-ejercicio1" class="btn-primary text-white px-6 py-2 rounded-lg font-medium transition-all duration-300 hover:shadow-lg dark:hover:shadow-purple-900/30">
                <i class="fas fa-check-circle mr-2"></i> Comprobar respuestas
              </button>
            </div>
          </div>
          
          <!-- Ejercicio 2 - Clasificaci√≥n -->
          <div id="content-ejercicio2" class="tab-content hidden">
            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-4">Clasifica las palabras seg√∫n la posici√≥n de la S</h3>
            <p class="text-gray-600 dark:text-gray-300 mb-6">Arrastra cada palabra al √°rea correspondiente seg√∫n la posici√≥n de la letra S en la palabra.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
              <div id="target-inicial" class="bg-blue-50 dark:bg-blue-900/20 border-2 border-dashed border-blue-300 dark:border-blue-700 rounded-xl p-4 min-h-32 flex flex-col">
                <div class="text-center text-blue-700 dark:text-blue-300 font-medium mb-2">
                  S inicial
                </div>
                <div class="flex-grow flex flex-wrap gap-2 content-start" id="words-inicial"></div>
              </div>
              
              <div id="target-media" class="bg-purple-50 dark:bg-purple-900/20 border-2 border-dashed border-purple-300 dark:border-purple-700 rounded-xl p-4 min-h-32 flex flex-col">
                <div class="text-center text-purple-700 dark:text-purple-300 font-medium mb-2">
                  S media
                </div>
                <div class="flex-grow flex flex-wrap gap-2 content-start" id="words-media"></div>
              </div>
              
              <div id="target-final" class="bg-green-50 dark:bg-green-900/20 border-2 border-dashed border-green-300 dark:border-green-700 rounded-xl p-4 min-h-32 flex flex-col">
                <div class="text-center text-green-700 dark:text-green-300 font-medium mb-2">
                  S final
                </div>
                <div class="flex-grow flex flex-wrap gap-2 content-start" id="words-final"></div>
              </div>
            </div>
            
            <div id="palabras-arrastrar" class="flex flex-wrap gap-3 p-4 bg-gray-50 dark:bg-dark-600 rounded-lg">
              <div class="bg-white dark:bg-dark-700 shadow-sm rounded-lg px-4 py-2 cursor-move draggable-word" draggable="true" data-posicion="inicial">
                <span class="text-gray-800 dark:text-gray-200">sol</span>
              </div>
              <div class="bg-white dark:bg-dark-700 shadow-sm rounded-lg px-4 py-2 cursor-move draggable-word" draggable="true" data-posicion="media">
                <span class="text-gray-800 dark:text-gray-200">casa</span>
              </div>
              <div class="bg-white dark:bg-dark-700 shadow-sm rounded-lg px-4 py-2 cursor-move draggable-word" draggable="true" data-posicion="final">
                <span class="text-gray-800 dark:text-gray-200">despu√©s</span>
              </div>
              <div class="bg-white dark:bg-dark-700 shadow-sm rounded-lg px-4 py-2 cursor-move draggable-word" draggable="true" data-posicion="inicial">
                <span class="text-gray-800 dark:text-gray-200">sapo</span>
              </div>
              <div class="bg-white dark:bg-dark-700 shadow-sm rounded-lg px-4 py-2 cursor-move draggable-word" draggable="true" data-posicion="media">
                <span class="text-gray-800 dark:text-gray-200">mesa</span>
              </div>
              <div class="bg-white dark:bg-dark-700 shadow-sm rounded-lg px-4 py-2 cursor-move draggable-word" draggable="true" data-posicion="final">
                <span class="text-gray-800 dark:text-gray-200">adi√≥s</span>
              </div>
            </div>
            
            <div id="feedback-arrastrar" class="hidden mt-6">
              <div class="p-4 rounded-lg bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 feedback-content">
                <div class="flex items-center">
                  <i class="fas fa-check-circle text-green-500 dark:text-green-400 text-xl mr-3"></i>
                  <div>
                    <h4 class="font-bold text-green-800 dark:text-green-200">¬°Bien hecho!</h4>
                    <p class="text-green-700 dark:text-green-300 text-sm">Has clasificado correctamente todas las palabras seg√∫n la posici√≥n de la S.</p>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="mt-6 flex justify-between">
              <button id="reset-ejercicio2" class="bg-gray-200 hover:bg-gray-300 dark:bg-purple-600 dark:hover:bg-dark-500 text-gray-800 dark:text-gray-200 px-6 py-2 rounded-lg font-medium transition-colors duration-300">
                <i class="fas fa-redo mr-2"></i> Reiniciar
              </button>
              <button id="check-ejercicio2" class="btn-primary text-white px-6 py-2 rounded-lg font-medium transition-all duration-300 hover:shadow-lg dark:hover:shadow-purple-900/30">
                <i class="fas fa-check-circle mr-2"></i> Comprobar
              </button>
            </div>
          </div>
          
          <!-- Ejercicio 3 - Dictado -->
          <div id="content-ejercicio3" class="tab-content hidden">
            <h3 class="text-xl font-bold text-gray-800 dark:text-gray-100 mb-4">Dictado con palabras que contienen S</h3>
            <p class="text-gray-600 dark:text-gray-300 mb-6">Escucha atentamente y escribe las palabras que contengan la letra S.</p>
            
            <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-6 mb-6 border border-blue-100 dark:border-blue-800 transition-colors duration-300">
              <div id="dictation-audio" class="hidden mb-4">
                <audio controls class="w-full">
                  <source src="../../assets/audio/pronunciation_es_silla.mp3" type="audio/mpeg">
                </audio>
              </div>
              
              <button id="start-dictation" class="btn-secondary text-white px-6 py-3 rounded-lg font-medium w-full transition-all duration-300 hover:shadow-lg dark:hover:shadow-pink-900/30">
                <i class="fas fa-microphone mr-2"></i> Iniciar dictado
              </button>
            </div>
            
            <div class="mb-6">
              <label for="dictation-text" class="block text-gray-700 dark:text-gray-300 font-medium mb-2">Escribe las palabras que escuches:</label>
              <textarea id="dictation-text" rows="4" class="w-full border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-dark-700 dark:border-gray-600 dark:text-white"></textarea>
            </div>
            
            <div id="dictation-feedback" class="hidden p-4 rounded-lg bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-700 mb-6 transition-colors duration-300">
              <div class="flex items-center">
                <i class="fas fa-info-circle text-purple-600 dark:text-purple-400 text-xl mr-3"></i>
                <div>
                  <h4 class="font-bold text-purple-800 dark:text-purple-200">Retroalimentaci√≥n</h4>
                  <p class="text-purple-700 dark:text-purple-300 text-sm">Las palabras que conten√≠an S eran: <span id="dictation-words" class="font-bold">sapo, sol, mesa</span></p>
                </div>
              </div>
            </div>
            
            <div class="flex justify-end">
              <button id="check-dictation" class="btn-primary text-white px-6 py-2 rounded-lg font-medium transition-all duration-300 hover:shadow-lg dark:hover:shadow-purple-900/30">
                <i class="fas fa-check-circle mr-2"></i> Comprobar dictado
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Secci√≥n de finalizaci√≥n -->
    <section class="mb-12">
      <div class="bg-gradient-to-r from-purple-600 to-blue-500 dark:from-purple-700 dark:to-blue-600 rounded-xl shadow-lg overflow-hidden p-8 text-center transition-colors duration-300">
        <div class="max-w-2xl mx-auto">
          <h2 class="text-2xl font-bold text-white mb-4">¬øListo para completar la lecci√≥n?</h2>
          <p class="text-purple-100 mb-6">Has progresado mucho. Completa todos los ejercicios para finalizar esta lecci√≥n.</p>
          
          <div class="flex flex-col sm:flex-row justify-center gap-4">
            <button id="btn-completar" class="bg-white text-purple-600 hover:bg-gray-100 px-6 py-3 rounded-lg font-medium shadow-md transition hover:shadow-lg">
              <i class="fas fa-flag-checkered mr-2"></i> Terminar lecci√≥n
            </button>
            
            <button id="btn-reiniciar-todo" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white px-6 py-3 rounded-lg font-medium shadow-md transition hover:shadow-lg">
              <i class="fas fa-redo mr-2"></i> Reiniciar todo
            </button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-800 dark:bg-dark-900 text-gray-300 dark:text-gray-400 py-8 border-t border-gray-700 dark:border-gray-800 transition-colors duration-300">
    <div class="container mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="mb-4 md:mb-0">
          <a href="../../index.html" class="flex items-center text-xl font-bold text-white">
            <img src="../../assets/images/savila.png" alt="Logo GRAFI" class="w-8 h-8 mr-2">
            <span>Grafema</span>
          </a>
          <p class="mt-2 text-sm">Aprendizaje interactivo de grafemas y fonemas.</p>
        </div>
        
        <div class="flex space-x-4">
          <a href="https://www.facebook.com/profile.php?id=100009295328147&locale=es_LA" class="text-gray-400 hover:text-white transition">
            <i class="fab fa-facebook-f"></i>
          </a>
          <a href="https://www.instagram.com/joelmolina54/" class="text-gray-400 hover:text-white transition">
            <i class="fab fa-instagram"></i>
          </a>
          <a href="https://github.com/joelmolina54" class="text-gray-400 hover:text-white transition">
            <i class="fab fa-github"></i>
          </a>
        </div>
      </div>
      
      <div class="border-t border-gray-700 dark:border-gray-800 mt-6 pt-6 text-center text-sm">
        <p>&copy; 2025 GRAFI. Todos los derechos reservados.</p>
      </div>
    </div>
  </footer>

  <!-- Modal universal -->
  <div id="universal-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
    <div class="bg-white dark:bg-dark-700 rounded-xl shadow-2xl overflow-hidden w-full max-w-md transform transition-all">
      <div id="modal-header" class="gradient-bg dark:bg-gradient-to-r dark:from-purple-900 dark:to-purple-800 p-6 text-center text-white">
        <i id="modal-icon" class="fas fa-check-circle text-4xl mb-4"></i>
        <h3 id="modal-title" class="text-2xl font-bold">T√≠tulo del modal</h3>
      </div>
      
      <div class="p-6 text-center">
        <p id="modal-message" class="text-gray-600 dark:text-gray-300 mb-6">Mensaje del modal aqu√≠.</p>
        
        <div class="flex flex-col space-y-3">
          <button id="modal-primary-btn" class="btn-primary text-white px-6 py-3 rounded-lg font-medium transition-all duration-300 hover:shadow-lg dark:hover:shadow-purple-900/30">
            <i class="fas fa-check mr-2"></i> Aceptar
          </button>
          <button id="modal-secondary-btn" class="border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-dark-600 px-6 py-3 rounded-lg font-medium transition-colors duration-300 hidden">
            <i class="fas fa-times mr-2"></i> Cancelar
          </button>
        </div>
      </div>
    </div>
  </div>

  
  <script src="../../assets/js/temaleccionesclases.js"></script>
  <script src="../../assets/js/menu-movil.js"></script>
<script>
  
document.addEventListener('DOMContentLoaded', function() {
    // Cargar progreso
    const progreso = localStorage.getItem('progreso-s') || 0;
    updateProgress(progreso);

    // Configuraciones iniciales
    setupTabs();
    setupDragDrop();
    setupButtons();
    
    // Verificar si ya est√° completada
    if (progreso == 100) {
        const btn = document.getElementById('btn-completar');
        btn.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Lecci√≥n completada';
        btn.classList.add('bg-green-100', 'text-green-800', 'hover:bg-green-100');
    }
});


  
  // Configurar modal universal
  function setupModal() {
    const modal = document.getElementById('universal-modal');

    modal.addEventListener('click', function(e) {
      if (e.target === this) closeModal();
    });

    document.getElementById('modal-primary-btn').addEventListener('click', function() {
      const action = this.getAttribute('data-action');
      if (action === 'redirect') window.location.href = '../lecciones.html';
      closeModal();
    });

    document.getElementById('modal-secondary-btn').addEventListener('click', closeModal);
  }

  function closeModal() {
    document.getElementById('universal-modal').classList.add('hidden');
  }

  // Actualizar progreso visual
function updateProgress(percent) {
    // Actualizar barra de progreso
    document.getElementById('progress-bar').style.width = `${percent}%`;
    
    // Actualizar anillo de progreso
    const circle = document.getElementById('progress-ring');
    if (circle) {
        const radius = circle.r.baseVal.value;
        const circumference = 2 * Math.PI * radius;
        const offset = circumference - (percent / 100) * circumference;
        circle.style.strokeDashoffset = offset;
    }
    
    // Actualizar bot√≥n de completar si llega al 100%
    if (percent >= 100) {
        const btn = document.getElementById('btn-completar');
        btn.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Lecci√≥n completada';
        btn.classList.add('bg-green-100', 'text-green-800', 'hover:bg-green-100');
        btn.classList.remove('bg-white', 'text-purple-600', 'hover:bg-gray-100');
    }
}

  // Configurar sistema de pesta√±as
  function setupTabs() {
    const tabs = document.querySelectorAll('.tab-button');
    const contents = document.querySelectorAll('.tab-content');

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active', 'border-purple-500', 'text-purple-600'));
        tabs.forEach(t => t.classList.add('border-transparent', 'text-gray-500'));
        contents.forEach(c => c.classList.remove('active'));
        contents.forEach(c => c.classList.add('hidden'));

        tab.classList.add('active', 'border-purple-500', 'text-purple-600');
        tab.classList.remove('border-transparent', 'text-gray-500');

        const contentId = tab.id.replace('tab-', 'content-');
        document.getElementById(contentId).classList.add('active');
        document.getElementById(contentId).classList.remove('hidden');
      });
    });
  }

  // Drag and drop
  function setupDragDrop() {
    const draggables = document.querySelectorAll('.draggable-word');
    const targets = document.querySelectorAll('[id^="target-"]');

    draggables.forEach(d => {
      d.addEventListener('dragstart', () => d.classList.add('opacity-50', 'border-yellow-500'));
      d.addEventListener('dragend', () => d.classList.remove('opacity-50', 'border-yellow-500'));
    });

    targets.forEach(target => {
      target.addEventListener('dragover', e => {
        e.preventDefault();
        const afterElement = getDragAfterElement(target, e.clientY);
        const draggable = document.querySelector('.draggable-word.border-yellow-500');

        if (afterElement == null) target.appendChild(draggable);
        else target.insertBefore(draggable, afterElement);
      });
    });
  }

  function getDragAfterElement(container, y) {
    const draggableElements = [...container.querySelectorAll('.draggable-word:not(.border-yellow-500)')];
    return draggableElements.reduce((closest, child) => {
      const box = child.getBoundingClientRect();
      const offset = y - box.top - box.height / 2;
      if (offset < 0 && offset > closest.offset) return { offset: offset, element: child };
      else return closest;
    }, { offset: Number.NEGATIVE_INFINITY }).element;
  }

  function setupButtons() {
    const btnEj1 = document.getElementById('check-ejercicio1');
    if (btnEj1) {
        btnEj1.addEventListener('click', function() {
            let allCorrect = true;
            const containers = document.querySelectorAll('.ejercicio-container');

            containers.forEach(container => {
                const select = container.querySelector('.ejercicio-select');
                const feedback = container.querySelector('.ejercicio-feedback');
                const correctIcon = container.querySelector('.correct-icon');
                const incorrectIcon = container.querySelector('.incorrect-icon');
                const feedbackText = container.querySelector('.feedback-text');
                const respuestaCorrecta = container.getAttribute('data-respuesta');

                if (!select || !feedback || !correctIcon || !incorrectIcon || !feedbackText) return;

                feedback.classList.remove('hidden');

                if (select.value === respuestaCorrecta) {
                    correctIcon.classList.remove('hidden');
                    incorrectIcon.classList.add('hidden');
                    container.classList.add('border-green-200', 'bg-green-50');
                    container.classList.remove('border-red-200', 'bg-red-50', 'shake');

                    feedbackText.textContent = `¬°Correcto! La respuesta es "${respuestaCorrecta.toUpperCase()}".`;
                    feedbackText.className = 'text-sm text-green-600 feedback-text';
                } else {
                    correctIcon.classList.add('hidden');
                    incorrectIcon.classList.remove('hidden');
                    container.classList.add('border-red-200', 'bg-red-50', 'shake');
                    container.classList.remove('border-green-200', 'bg-green-50');
                    allCorrect = false;

                    feedbackText.textContent = `Incorrecto. La respuesta correcta es "${respuestaCorrecta.toUpperCase()}".`;
                    feedbackText.className = 'text-sm text-red-600 feedback-text';
                }
            });

            if (allCorrect) {
                updateProgress(30);
                showModal({
                    title: '¬°Ejercicio completado!',
                    message: 'Has respondido correctamente todas las preguntas del primer ejercicio.',
                    icon: 'fas fa-check-circle text-green-500',
                    primaryText: 'Continuar'
                });
            }
        });
    }

    // --- Bot√≥n reiniciar ---
    const btnReiniciarTodo = document.getElementById('btn-reiniciar-todo');
    if (btnReiniciarTodo) {
        btnReiniciarTodo.addEventListener('click', function () {
            showModal({
                title: 'Reiniciar lecci√≥n',
                message: '¬øSeguro que quieres reiniciar todo el progreso de esta lecci√≥n?',
                icon: 'fas fa-exclamation-triangle text-yellow-500',
                primaryText: 'S√≠, reiniciar',
                secondaryText: 'Cancelar',
                onPrimary: () => {
                    localStorage.removeItem('progreso-s');
                    location.reload();
                }
            });
        });
    }
}
   // Ejercicio 2: clasificaci√≥n
document.getElementById('check-ejercicio2').addEventListener('click', function() {
    const palabrasInicial = document.querySelectorAll('#target-inicial .draggable-word');
    const palabrasMedia = document.querySelectorAll('#target-media .draggable-word');
    const palabrasFinal = document.querySelectorAll('#target-final .draggable-word');

    let correctas = 0;
    let totalPalabras = 6; // Total de palabras a clasificar

    // Verificar palabras con S inicial
    palabrasInicial.forEach(palabra => {
        if (palabra.getAttribute('data-posicion') === 'inicial') correctas++;
    });

    // Verificar palabras con S media
    palabrasMedia.forEach(palabra => {
        if (palabra.getAttribute('data-posicion') === 'media') correctas++;
    });

    // Verificar palabras con S final
    palabrasFinal.forEach(palabra => {
        if (palabra.getAttribute('data-posicion') === 'final') correctas++;
    });

    if (correctas === totalPalabras) {
        updateProgress(60); // Actualizar progreso si todo es correcto
        showModal({
            title: '¬°Perfecto!',
            message: 'Has clasificado correctamente todas las palabras seg√∫n la posici√≥n de la S.',
            icon: 'fas fa-check-circle text-green-500',
            primaryText: 'Continuar'
        });
    } else {
        showModal({
            title: '¬°Ups! Hay errores',
            message: `Tienes ${correctas} de ${totalPalabras} palabras correctas. Revisa la posici√≥n de la S.`,
            icon: 'fas fa-exclamation-circle text-yellow-500',
            primaryText: 'Intentar de nuevo'
        });
    }
});
    // Dictado
    document.getElementById('start-dictation').addEventListener('click', function() {
      document.getElementById('dictation-audio').classList.remove('hidden');
      document.getElementById('start-dictation').innerHTML = '<i class="fas fa-volume-up mr-2"></i> Escuchando...';
      document.getElementById('start-dictation').classList.add('bg-yellow-600');
      document.getElementById('start-dictation').classList.remove('btn-secondary');

      setTimeout(() => {
        document.getElementById('start-dictation').innerHTML = '<i class="fas fa-check mr-2"></i> Dictado completado';
        document.getElementById('start-dictation').classList.add('bg-green-500');
        document.getElementById('start-dictation').classList.remove('bg-yellow-600');
      }, 3000);
    });

    // Ejercicio 3 - Dictado
document.getElementById('check-dictation').addEventListener('click', function() {
    const textoUsuario = document.getElementById('dictation-text').value.toLowerCase();
    const palabrasEsperadas = ['silla']; // Palabras con S que deber√≠a escuchar
    
    // Verificar cu√°ntas palabras con S encontr√≥
    const palabrasEncontradas = palabrasEsperadas.filter(palabra => 
        textoUsuario.includes(palabra)
    );
    
    // Mostrar retroalimentaci√≥n
    document.getElementById('dictation-feedback').classList.remove('hidden');
    document.getElementById('dictation-words').textContent = palabrasEsperadas.join(', ');
    
    if (palabrasEncontradas.length === palabrasEsperadas.length) {
        updateProgress(100); // Completar lecci√≥n si todo est√° bien
        showModal({
            title: '¬°Dictado perfecto! üéâ',
            message: `Identificaste todas las palabras con S: ${palabrasEncontradas.join(', ')}.`,
            icon: 'fas fa-check-circle text-green-500',
            primaryText: 'Finalizar lecci√≥n',
            onPrimary: () => {
                localStorage.setItem('progreso-s', '100');
                window.location.href = '../lecciones.html'; // Redirigir al completar
            }
        });
    } 
    else if (palabrasEncontradas.length > 0) {
        showModal({
            title: 'Buen intento üëç',
            message: `Solo encontraste ${palabrasEncontradas.length} de ${palabrasEsperadas.length} palabras. Intenta nuevamente.`,
            icon: 'fas fa-info-circle text-blue-500',
            primaryText: 'Repetir dictado'
        });
    } 
    else {
        showModal({
            title: 'No encontraste palabras con S ‚ùå',
            message: 'Escucha con atenci√≥n el sonido /s/ en el dictado.',
            icon: 'fas fa-times-circle text-red-500',
            primaryText: 'Volver a intentar'
        });
    }
});

document.getElementById('btn-completar').addEventListener('click', function() {
    const progreso = parseInt(document.getElementById('progress-bar').style.width) || 0;
    
    if (progreso >= 100) {
        // 1. Registrar lecci√≥n completada
        let completedLessons = JSON.parse(localStorage.getItem('completedLessons') || '[]');

        if (!completedLessons.includes('s')) {
            completedLessons.push('s');
            localStorage.setItem('completedLessons', JSON.stringify(completedLessons));
            
            // 2. Registrar en el contador general
            if (window.achievements) {
                window.achievements.completeLesson();
            }
            
            // 3. Guardar progreso espec√≠fico de esta lecci√≥n
            localStorage.setItem('progreso-s', '100');
            
            // 4. Mostrar confirmaci√≥n
            showModal({
                title: '¬°Lecci√≥n completada!',
                message: 'Has terminado con √©xito la lecci√≥n sobre la letra S.',
                icon: 'fas fa-check-circle text-green-500',
                primaryText: 'Volver a lecciones',
                onPrimary: () => {
                    window.location.href = '../lecciones.html';
                }
            });
        } else {
            showModal({
                title: 'Lecci√≥n ya completada',
                message: 'Ya hab√≠as completado esta lecci√≥n anteriormente.',
                icon: 'fas fa-info-circle text-blue-500',
                primaryText: 'Entendido'
            });
        }
    } else {
        showModal({
            title: 'Lecci√≥n incompleta',
            message: `Tu progreso actual es del ${progreso}%. Completa todos los ejercicios.`,
            icon: 'fas fa-exclamation-triangle text-yellow-500',
            primaryText: 'Continuar practicando'
        });
    }
});

  // Men√∫ de video
  document.getElementById('video-menu-btn').addEventListener('click', function() {
    document.getElementById('video-menu').classList.toggle('hidden');
  });

  function suggestVideo() {
    showModal('Sugerir video', '¬øQu√© video te gustar√≠a ver sobre este tema?', 'info', {
      primaryText: 'Enviar sugerencia',
      primaryIcon: 'fa-paper-plane'
    });
    document.getElementById('video-menu').classList.add('hidden');
  }

  function changeSpeed() {
    showModal('Cambiar velocidad', 'Selecciona la velocidad de reproducci√≥n del video:', 'info', {
      primaryText: 'Aplicar',
      primaryIcon: 'fa-check'
    });
    document.getElementById('video-menu').classList.add('hidden');
  }

function showModal({ title, message, icon, primaryText, secondaryText, onPrimary }) {
    const modal = document.getElementById('universal-modal');
    const modalIcon = document.getElementById('modal-icon');
    const modalTitle = document.getElementById('modal-title');
    const modalMessage = document.getElementById('modal-message');
    const primaryBtn = document.getElementById('modal-primary-btn');
    const secondaryBtn = document.getElementById('modal-secondary-btn');

    // Configurar contenido
    modalTitle.textContent = title;
    modalMessage.textContent = message;
    modalIcon.className = icon + ' text-4xl mb-4';

    // Configurar bot√≥n primario
    primaryBtn.innerHTML = `<i class="fas fa-check mr-2"></i> ${primaryText}`;
    primaryBtn.onclick = function() {
        if (onPrimary) onPrimary();
        closeModal();
    };

    // Configurar bot√≥n secundario si existe
    if (secondaryText) {
        secondaryBtn.innerHTML = `<i class="fas fa-times mr-2"></i> ${secondaryText}`;
        secondaryBtn.classList.remove('hidden');
        secondaryBtn.onclick = closeModal;
    } else {
        secondaryBtn.classList.add('hidden');
    }

    // Mostrar modal
    modal.classList.remove('hidden');
}
</script>

</body>
</html>